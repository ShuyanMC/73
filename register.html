<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="box">
        <h2>æ³¨å†Œ</h2>
        <div class="input-box">
            <label>è´¦å·</label>
            <input type="text" id="username"/>
            <div id="username-error" class="error-message"></div>
        </div>
        <div class="input-box">
            <label>å¯†ç </label>
            <input type="password" id="password"/>
            <div id="password-error" class="error-message"></div>
            <div id="password-strength" class="password-strength">
                <div><span id="length-check">âŒ</span>8-16ä½å¯†ç </div>
                <div><span id="uppercase-check">âŒ</span>åŒ…å«å¤§å†™å­—æ¯</div>
                <div><span id="number-check">âŒ</span>åŒ…å«æ•°å­—</div>
            </div>
        </div>
        <div class="input-box">
            <label>QQå·</label>
            <input type="text" id="qq"/>
            <div id="qq-error" class="error-message"></div>
        </div>
        <div class="input-box">
            <label>é‚®ç®±</label>
            <input type="email" id="email"/>
            <div id="email-error" class="error-message"></div>
        </div>
        <div class="btn-box">
            <button onclick="register()">æ³¨å†Œ</button>
        </div>
    </div>
    
    <script type="text/javascript">
        const backgrounds = [
                   "image/bg2.jpg",
                   "image/bg3.jpg",
                   "image/bg4.jpg",
                   "image/bg5.jpg",
                   "image/bg6.jpg",
               ];

               // è·å–èƒŒæ™¯å›¾å…ƒç´ 
               const body = document.body;

               // åˆ‡æ¢èƒŒæ™¯å›¾çš„å‡½æ•°
               function changeBackground() {
                   const randomIndex = Math.floor(Math.random() * backgrounds.length);
                   body.style.backgroundImage = `url(${backgrounds[randomIndex]})`;
               }

               // é¡µé¢åŠ è½½æ—¶åˆ‡æ¢èƒŒæ™¯å›¾
               window.onload = changeBackground;

        function register() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const qq = document.getElementById('qq').value;
            const email = document.getElementById('email').value;
            fetch('http://localhost:3000/register', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ username, password, qq, email }),
            })
            .then(response => response.json())
            .then(data => {
                if (data.message === "æ³¨å†ŒæˆåŠŸ--OVOğŸ…") {
                    window.location.href = 'login.html'; // æ³¨å†ŒæˆåŠŸåè·³è½¬åˆ°ç™»å½•é¡µé¢
                } else {
                    displayError(data.field, data.message);
                }
            })
            .catch((error) => {
                console.error('Error:', error);
            });
        }
        
        function checkPasswordStrength() {
            const password = document.getElementById('password').value;
            const lengthCheck = document.getElementById('length-check');
            const uppercaseCheck = document.getElementById('uppercase-check');
            const numberCheck = document.getElementById('number-check');
            
            const hasLength = password.length >= 8;
            const hasUppercase = /[A-Z]/.test(password);
            const hasNumber = /\d/.test(password);
            
            lengthCheck.textContent = hasLength ? 'âœ…' : 'âŒ';
            uppercaseCheck.textContent = hasUppercase ? 'âœ…' : 'âŒ';
            numberCheck.textContent = hasNumber ? 'âœ…' : 'âŒ';
        }
        
        document.getElementById('password').addEventListener('input', checkPasswordStrength);
        function displayError(field, message) {
            const errorElement = document.getElementById(`${field}-error`);
            errorElement.textContent = message;
        }
    </script>
</body> </html>
